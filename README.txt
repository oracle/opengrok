OpenGrok - a wicked fast source browser
---------------------------------------

OpenGrok is a fast and usable source code search and cross reference
engine, written in Java. It helps you search, cross-reference and navigate
your source tree. It can understand various program file formats and
version control histories like SCCS, RCS, CVS, Subversion and Mercurial.

OpenGrok is the tool used for the OpenSolaris Source Browser.

Requirements
------------
    * Latest Java http://java.sun.com/ (At least 1.5)
    * A servlet container like Tomcat (5.x or later)
      http://tomcat.apache.org/
      supporting Servlet 2.4 and JSP 2.0
    * Exuberant Ctags http://ctags.sourceforge.net/
    * Subversion 1.3.0 or later if SVN support is needed
      http://subversion.tigris.org/
    * Mercurial 0.9.3 or later if Mercurial support is needed
      http://www.selenic.com/mercurial/wiki/
    * JFlex Ant task (If you want to build OpenGrok)
      http://www.jflex.org/


Usage
-----
SRC_ROOT refers to the directory containing your source tree.
OpenGrok analyzes the source tree and builds a search index along with
cross-referenced hypertext versions of the source files. These generated
data files will be stored in DATA_ROOT directory. 

OpenGrok setup Step.0 - Setting up the Sources.
----------------------------------------------
Source base must be available locally for OpenGrok to work efficiently. No
changes are required to your source tree. If the code is under source control
management (SCM) OpenGrok requires the checked out source tree under SRC_ROOT.
It is possible for some SCM systems to use a remote repository (Subversion),
but this is not recommended due to the performance penalty. CVS must have a
local repository.
Note that OpenGrok ignores symbolic links.

---------------------------------------------------
Using command line interface.
---------------------------------------------------

Step.1 - Populate DATA_ROOT Directory
=====================================
Option 1. run.sh: There is a sample shell script run.sh that is suitable
for using in a cronjob to run regularly. Modify the variables in the script
to point appropriate directories.

Option 2. opengrok.jar: You can also directly use the Java application. If
the sources are all located in a directory SRC_ROOT and the data and
hypertext files generated by OpenGrok are to be stored in DATA_ROOT, run

     $ java -jar opengrok.jar -s SRC_ROOT DATA_ROOT

See opengrok.jar manual below for more details.

Step.2 - Configure and Deploy source.war Webapp
===============================================
To configure the webapp source.war, look into the parameters defined in
web.xml of source.war file and change them (see note1) appropriately.

    * HEADER: is the fragment of HTML that will be used to display title or
    logo of your project
    * SRC_ROOT: the absolute path name of the root directory of your source tree
    * DATA_ROOT: absolute path of the directory where OpenGrok data
    files are stored


Optional Step.3 - Path Descriptions
-----------------------------------
OpenGrok uses path descriptions in various places (For eg. while showing
directory listings or search results) Example descriptions are in paths.tsv
file. You can list descriptions for directories one per line tab separated
format path tab description. Refer to example 4 below.

Note 1 - Changing webapp parameters: web.xml is the deployment descriptor
for the web application. It is in a Jar file named source.war, you can
change the :

    * Option 1: Unzip the file to TOMCAT/webapps/source/ directory and
    change the source/WEB-INF/web.xml and other static html files like
    index.html to customize to your project. 
    
    * Option 2: Extract the web.xml file from source.war file

    	$ unzip source.war WEB-INF/web.xml
	
    edit web.xml and re-package the jar file. 

    	$ zip -u source.war WEB-INF/web.xml

    Then copy the war files to <i>TOMCAT</i>/webapps directory.

    * Option 3: Edit the Context container element for the webapp

	Copy source.war to TOMCAT/webapps

        When invoking OpenGrok to build the index, use -w <webapp> to set the 
        context.

        After the index is built, there's a couple different ways to set the
        Context for the servlet container:
          - Add the Context inside a Host element in TOMCAT/conf/server.xml

	    <Context path="/<webapp>" docBase="source.war">
	        <Parameter name="DATA_ROOT" value="/path/to/data/root" override="false" />
		<Parameter name="SRC_ROOT" value="/path/to/src/root" override="false" />
		<Parameter name="HEADER" value='...' override="false" />
	        <Parameter name="SCAN_REPOS" value="false" override="false/>
	    </Context>

          - Create a Context file for the webapp

	    This file will be named `<webapp>.xml'.

	    For Tomcat, the file will be located at:
	    `TOMCAT/conf/<engine_name>/<hostname>', where <engine_name>
	    is the Engine that is processing requests and <hostname> is a Host
	    associated with that Engine.  By default, this path is
	    'TOMCAT/conf/Catalina/localhost' or 'TOMCAT/conf/Standalone/localhost'.

	    This file will contain something like the Context described above.

Optional Step 4 -- Subversion setup 
----------------------------------- 
Some additional setup is needed if you are using Subversion.  OpenGrok uses
the Subversion javahl bindings, which are requires the native library `svnjavahl'.
The path to this library needs to be added to java.library.path for both the
OpenGrok application and the OpenGrok web application.

If you need to host multiple OpenGrok web applications, do the following:
    * Make sure that the path to `svnjavahl' had been added to the 
      java.library.path of the servlet container.
    * Extract source.war and move `WEB-INF/lib/svn-javahl.jar' where it will
      only be loaded by the servlet container once for all web applications.
      For Tomcat 5.x, this is `TOMCAT/common/lib/svn-javahl.jar'
    * Repackage source.war.  This will be the basis of your web applications.

---------------------------------------------------
Using Standalone Swing GUI
---------------------------------------------------
opengrok.jar when invoked without any arguments, opens up the GUI search window.
The interface is similar to cscope. 

To create an index, first select the browse button for "Search" drop down list.
Choose a directory to store the index (DATA_ROOT), and select the source tree 
(SRC_ROOT). You may have to also select path to ctags in the Advanced Options, 
if exuberant ctags can not be found in the PATH.

Clicking "Update" will create or update the search index.

The index can be searched using the cscope like GUI, which lets you customize
your favorite editor to open the matching files.

AUTHORS 
-------
Chandan B.N, Sun Microsystems. https://blogs.sun.com/chandan
Trond Norbye, norbye.org
Knut Pape, eBriefkasten.de
Martin Englund, Sun Microsystems
Knut Anders Hatlen, Sun Microsystems
